@(lobbyId: String, username: String)(implicit request: play.api.mvc.RequestHeader)
@import helper.CSRF 

@main("Lobby") {
  <head>
  <meta name="csrf-token" content="@helper.CSRF.getToken.value">
  <style>

body {
	margin: 0;
	padding: 0;
	width: 100vw;
	height: 100vh;
	overflow: hidden;
	align-items: center;
	justify-content: center;
	background: #8d745d;
	--clip: #59443b;
}

body:before, body:after {
	background: repeating-conic-gradient(#0003 0.000001%, #fff0 .00005%, #fff0 .00035%, #fff0 .00005%), repeating-conic-gradient(#fff2 0.00002%, #fff0 .00008%, #fff0 .0008%, #fff0 .00008%);
	opacity: 0.75;
	filter: blur(1px);
}
    .chat-container {
      position: fixed;
      right: 20px;
      bottom: 20px;
      width: 300px;
      max-height: 500px;
      display: flex;
      flex-direction: column;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      border-radius: 10px;
      overflow: hidden;
      background-color: #f8f9fa;
    }

    .chat-header {
      background-color: #0d6efd;
      color: white;
      padding: 10px;
      font-weight: bold;
      text-align: center;
      cursor: pointer;
        user-select: none;
    }

    .chat-messages {
      flex: 1;
      padding: 10px;
      overflow-y: auto;
    }

    .chat-input {
      display: flex;
      border-top: 1px solid #ddd;
    }

    .chat-input input {
      flex: 1;
      border: none;
      padding: 10px;
      outline: none;
    }

    .chat-input button {
      border: none;
      background-color: #0d6efd;
      color: white;
      padding: 0 15px;
    }


    .message {
      font-family: monospace;
      margin-bottom: 10px;
      padding: 5px 10px;
      border-radius: 8px;
      background-color: #e9ecef;
    }

    .message .timestamp {
        font-size: 0.8em;
        margin-bottom: 8px;
    }

    .message .user {
      font-weight: bold;
      color: #0d6efd;
      margin-bottom: 3px;
    }

    .minimize-btn {
  float: right;
  background: transparent;
  border: none;
  color: white;
  font-size: 1.2em;
  cursor: pointer;
  line-height: 1;
  padding: 0 5px;
}

.minimize-btn:focus {
  outline: none;
}

.chat-container.minimized {
  height: auto; /* shrink to just header */
  width: 200px; /* optional smaller width */
}

.chat-container.minimized .chat-messages,
.chat-container.minimized .chat-input {
  display: none;
}
  </style>
</head>
<body>

<script>
  $(function() {
    const urlParams = new URLSearchParams(window.location.search);
    const state = urlParams.get('state');
    if (state === "created") {
      showToast("New lobby created.", "success");
    } else {
      showToast("You joined a lobby.");
    }

    const chatHeader = document.getElementById('chatHeader');
    const chatContainer = document.getElementById('chatContainer');

    chatHeader.addEventListener('click', () => {
      chatContainer.classList.toggle('minimized');
    });
  });

</script>

   
<div id="badgeContainer" class="position-fixed top-0 start-0 m-2 d-flex flex-column align-items-start">
  <span class="badge bg-secondary mb-1">Lobby: @lobbyId</span>
  <span id="playerBadge" class="badge d-none"></span>

    <div class="alert alert-info p-2 mb-0 mt-2 flex-shrink-0 dice-panel" role="alert">
        <ul class="list-inline mb-0 d-inline">
        </ul>
    </div>
  </div>
  
  <div id="game" class="m-3">
    <div id="board-wrapper">
      <main id="board-area">
      </main>
    </div>  
  </div>

<div class="chat-container" id="chatContainer">
  <div class="chat-header" id="chatHeader">
    Chat
  </div>
  <div class="chat-messages" id="messagesDiv"></div>
  <div class="chat-input">
    <input type="text" id="chatInput" placeholder="Type a message...">
    <button id="sendBtn">Send</button>
  </div>
</div>
}

<script>
  const username = "@username";
  const lobbyId = "@lobbyId";
</script>
<script defer src='@routes.Assets.versioned("javascripts/websocket.js")'></script>
<script defer src='@routes.Assets.versioned("javascripts/boardSize.js")'></script>
<script defer src='@routes.Assets.versioned("javascripts/sendEvent.js")'></script>
